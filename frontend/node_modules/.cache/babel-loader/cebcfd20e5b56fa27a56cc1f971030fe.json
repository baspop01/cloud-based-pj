{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport axios from '@/plugins/axios';\nexport default {\n  data: function data() {\n    return {\n      user: null,\n      order: null,\n      orderLength: '',\n      myStyle: {\n        backgroundColor: \"black\"\n      }\n    };\n  },\n  mounted: function mounted() {\n    this.onAuthChange();\n  },\n  methods: {\n    getOrderAndTicket: function getOrderAndTicket(id) {\n      var _this = this;\n\n      axios.get(\"/order/ticket/\".concat(id)).then(function (res) {\n        _this.order = res.data.order;\n        var getOrder = res.data.order;\n        _this.orderLength = getOrder.length;\n      });\n    },\n    onAuthChange: function onAuthChange() {\n      var token = localStorage.getItem(\"token\");\n\n      if (token) {\n        this.getUser();\n      }\n    },\n    getUser: function getUser() {\n      var _this2 = this;\n\n      axios.get(\"/user/me\").then(function (res) {\n        _this2.user = res.data;\n\n        _this2.getOrderAndTicket(_this2.user.cid);\n\n        console.log(_this2.user.role);\n      });\n    },\n    logout: function logout() {\n      this.user = null, localStorage.removeItem(\"token\");\n      this.$router.push({\n        path: '/user/login'\n      });\n    },\n    isAdmin: function isAdmin() {\n      if (!this.user) return false;\n      return this.user.role == 'admin';\n    },\n    isCusto: function isCusto() {\n      if (!this.user) return false;\n      return this.user.role == 'customer';\n    }\n  }\n};","map":{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACAA,MADA,kBACA;AACA;AACAC,gBADA;AAEAC,iBAFA;AAGAC,qBAHA;AAIAC;AACAC;AADA;AAJA;AAQA,GAVA;AAWAC,SAXA,qBAWA;AACA;AACA,GAbA;AAcAC;AACAC,qBADA,6BACAC,EADA,EACA;AAAA;;AACAC,6CACAC,IADA,CACA;AACA;AACA;AACA;AACA,OALA;AAMA,KARA;AASAC,gBATA,0BASA;AACA;;AACA;AACA;AACA;AACA,KAdA;AAeAC,WAfA,qBAeA;AAAA;;AACAH,4BACAC,IADA,CACA;AACA;;AACA;;AACAG;AACA,OALA;AAMA,KAtBA;AAuBAC,UAvBA,oBAuBA;AACA,wBACAC,gCADA;AAEA;AAAAC;AAAA;AACA,KA3BA;AA4BAC,WA5BA,qBA4BA;AACA;AACA;AACA,KA/BA;AAgCAC,WAhCA,qBAgCA;AACA;AACA;AACA;AAnCA;AAdA","names":["data","user","order","orderLength","myStyle","backgroundColor","mounted","methods","getOrderAndTicket","id","axios","then","onAuthChange","getUser","console","logout","localStorage","path","isAdmin","isCusto"],"sourceRoot":"src","sources":["App.vue"],"sourcesContent":["<template>\n  <div :style=\"myStyle\" id=\"wrapper\">\n    <nav \n      class=\"navbar\"\n      role=\"navigation\"\n      aria-label=\"main navigation\"\n    >\n      <div class=\"navbar-brand\" v-if=\"user\">\n        <a class=\"navbar-item\" href=\"/\">\n          <img\n            src=\"https://media.discordapp.net/attachments/953696113448337498/968576596250357790/logo.png\"\n            width=\"30\"\n            height=\"100\"\n          />\n        </a>\n        <a\n          role=\"button\"\n          class=\"navbar-burger\"\n          aria-label=\"menu\"\n          aria-expanded=\"false\"\n          data-target=\"navbarBasicExample\"\n        >\n          <span aria-hidden=\"true\"></span>\n          <span aria-hidden=\"true\"></span>\n          <span aria-hidden=\"true\"></span>\n        </a>\n      </div>\n      <div id=\"navbarBasicExample\" class=\"navbar-menu\" v-if=\"user\">\n        <div class=\"navbar-start m-1\">\n          <router-link to=\"/\"\n            ><a class=\"navbar-item is-size-4 ml-5 has-background-grey-lighter has-text-danger\">\n              <strong>Home</strong>\n            </a></router-link>\n          <router-link to=\"/movies\"\n            ><a class=\"navbar-item is-size-4 ml-5 has-background-grey-lighter has-text-danger\">\n              <strong>Movie</strong>\n            </a></router-link>\n          <router-link v-if=\"isCusto()\" :to=\"`/profile/${user.cid}`\"\n            ><a class=\"navbar-item is-size-4 ml-5 has-background-grey-lighter has-text-danger\">\n              <strong>Profile</strong>\n            </a></router-link>\n          <router-link v-if=\"isCusto()\" :to=\"`/profile/myorder/${user.cid}`\"\n            ><a class=\"navbar-item is-size-4 ml-5 has-background-grey-lighter has-text-danger\">\n              <strong>My Order</strong>\n            </a></router-link>\n        </div>\n        <div class=\"navbar-end has-background-grey-lighter\">\n                   <div v-if=\"user\" class=\"navbar-item has-dropdown is-hoverable has-background-grey-lighter\">\n            <a class=\"navbar-link has-background-grey-lighter\">\n              <figure class=\"image is-24x24 my-auto\">\n                <img\n                  class=\"is-rounded\"\n                  src=\"https://upload.wikimedia.org/wikipedia/commons/thumb/7/7e/Circle-icons-profile.svg/2048px-Circle-icons-profile.svg.png\"\n                />\n              </figure>\n              <span class=\"pl-3 has-text-danger has-background-grey-lighter\"\n                >{{ user.email_id }}</span\n              >\n            </a>\n            <div class=\"navbar-dropdown has-background-grey-lighter\">\n              <router-link v-if=\"isCusto()\" :to='`/profile/${user.cid}`'><a class=\"navbar-item has-background-grey-lighter has-text-danger\">Profile</a></router-link>\n              <router-link v-if=\"isCusto()\" :to='`/profile/myorder/${user.cid}`'><a class=\"navbar-item has-background-grey-lighter has-text-danger\">My Order ({{orderLength}})</a></router-link>\n              <a @click=\"logout()\" class=\"navbar-item has-background-grey-lighter has-text-danger\">Log out</a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </nav>\n    <div id=\"app\">\n      <router-view :key=\"$route.fullPath\" @auth-change=\"onAuthChange\" :user=\"user\"/>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from '@/plugins/axios'\nexport default {\n  data() {\n    return {\n      user: null,\n      order: null,\n      orderLength: '',\n      myStyle: {\n        backgroundColor: \"black\",\n      },\n    };\n  },\n   mounted() {\n    this.onAuthChange();\n  },\n  methods: {\n    getOrderAndTicket(id){\n      axios.get(`/order/ticket/${id}`)\n        .then((res) => {\n          this.order = res.data.order;\n          var getOrder = res.data.order\n          this.orderLength = getOrder.length\n        });\n    },\n    onAuthChange() {\n      const token = localStorage.getItem(\"token\");\n      if (token) {\n        this.getUser();\n      }\n    },\n    getUser() {\n      axios.get(\"/user/me\")\n        .then((res) => {\n          this.user = res.data;\n          this.getOrderAndTicket(this.user.cid)\n          console.log(this.user.role)\n        });\n    },\n    logout(){\n      this.user = null,\n      localStorage.removeItem(\"token\");\n      this.$router.push({path: '/user/login'})\n    },\n    isAdmin(){\n      if (!this.user) return false\n      return this.user.role == 'admin'\n    },\n    isCusto(){\n      if (!this.user) return false\n      return this.user.role == 'customer'\n    }\n  },\n};\n</script>\n\n<style>\n@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300&family=Prompt:wght@200;300;500&display=swap');\n#app {\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n  font-family: 'Noto Sans Thai', sans-serif;\n  font-family: 'Prompt', sans-serif;\n}\n#wrapper {\n  width: auto;\n  height: 100%;\n  background-color: rgb(198, 241, 200);\n}\n*{\n  font-family: 'Noto Sans Thai', sans-serif;\n  font-family: 'Prompt', sans-serif;\n}\n.class\n</style>\n"]},"metadata":{},"sourceType":"module"}